(this["webpackJsonpfood-ordering"]=this["webpackJsonpfood-ordering"]||[]).push([[0],{215:function(e,a,t){},217:function(e,a,t){e.exports=t.p+"static/media/plus.311313cd.svg"},218:function(e,a,t){e.exports=t.p+"static/media/cross.441d8611.svg"},219:function(e,a,t){e.exports=t.p+"static/media/cart.890dce60.svg"},220:function(e,a,t){e.exports=t.p+"static/media/fobiden-order.6b4b70dc.svg"},221:function(e,a,t){e.exports=t.p+"static/media/congrats.211b8e65.svg"},222:function(e,a,t){e.exports=t.p+"static/media/checklist.80d775c4.svg"},224:function(e,a,t){e.exports=t.p+"static/media/logo.913ae04a.svg"},227:function(e,a,t){e.exports=t(483)},470:function(e,a,t){},471:function(e,a,t){},472:function(e,a,t){},477:function(e,a,t){},480:function(e,a,t){},483:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(50),s=t.n(c),l=t(99),i=t(13),o=t(8),u=t(21),m=t.n(u),d=t(40),E=t(2),p=t(216),f=t.n(p)()({menu:[function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(a.type){case"GET_MENU_LOADING":return Object(E.a)(Object(E.a)({},e),{},{isLoading:!0,menuList:[],getMenuFail:null});case"GET_MENU_SUCCESS":return Object(E.a)(Object(E.a)({},e),{},{isLoading:!1,menuList:a.payload,getMenuFail:null});case"GET_MENU_FAIL":return Object(E.a)(Object(E.a)({},e),{},{isLoading:!1,menuList:[],getMenuFail:a.payload.message});default:return e}},{menuList:[],isLoading:!1,getMenuFail:null}],currentUser:[function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(a.type){case"GET_CUR_USER_SUCCESS":return Object(E.a)(Object(E.a)({},e),{},{user:a.payload,userFail:null});case"GET_CUR_USER_FAIL":return Object(E.a)(Object(E.a)({},e),{},{user:{},userFail:a.payload.message});default:return e}},{user:{},userFail:null}],cart:[function(e,a){switch(a.type){case"ADD_CART_ITEM":return Object(E.a)(Object(E.a)({},e),{},{cartList:a.payload,cartAdded:!0});case"REMOVE_CART_ADDED":return Object(E.a)(Object(E.a)({},e),{},{cartAdded:!1});case"DELETE_CART_ITEM":var t=e.cartList,n=a.payload;return Object(E.a)(Object(E.a)({},e),{},{cartList:t.filter((function(e){return e.id!==n.id})),cartAdded:!1});case"DELETE_CART":return Object(E.a)(Object(E.a)({},e),{},{cartList:[],cartAdded:!1});default:return e}},{cartList:[],cartAdded:!1}],submitOrder:[function(e,a){switch(a.type){case"SUBMIT_ORDERS_REQUEST":return Object(E.a)(Object(E.a)({},e),{},{createOrderSuccess:!1,isLoading:!0,submitOrderFail:null});case"SUBMIT_ORDERS_SUCCESS":return Object(E.a)(Object(E.a)({},e),{},{createOrderSuccess:!0,isLoading:!1,submitOrderFail:null});case"SUBMIT_ORDERS_FAIL":return Object(E.a)(Object(E.a)({},e),{},{createOrderSuccess:!1,isLoading:!1,submitOrderFail:a.payload});default:return e}},{createOrderSuccess:!1,isLoading:!1,submitOrderFail:null}],orders:[function(e,a){switch(a.type){case"GET_ORDERS_REQUEST":return Object(E.a)(Object(E.a)({},e),{},{isLoading:!0,orderList:[],getOrdersFail:null});case"GET_ORDERS_SUCCESS":return Object(E.a)(Object(E.a)({},e),{},{isLoading:!1,orderList:a.payload,getOrdersFail:null});case"GET_ORDERS_FAIL":return Object(E.a)(Object(E.a)({},e),{},{isLoading:!1,orderList:[],getOrdersFail:a.payload.message});default:return e}},{orderList:[],isLoading:!1,getOrdersFail:null}],orderTimeout:[function(e,a){switch(a.type){case"SET_ORDER_TIMEOUT":return Object(E.a)(Object(E.a)({},e),{},{isOrderTimeout:!0});case"RESET_ORDER_TIMEOUT":return Object(E.a)(Object(E.a)({},e),{},{isOrderTimeout:!1});default:return e}},{isOrderTimeout:!1}],allOrders:[function(e,a){switch(a.type){case"GET_ALL_ORDERS_REQUEST":return Object(E.a)(Object(E.a)({},e),{},{isLoading:!0,orderList:[],getOrdersFail:null});case"GET_ALL_ORDERS_SUCCESS":return Object(E.a)(Object(E.a)({},e),{},{isLoading:!1,orderList:a.payload,getOrdersFail:null});case"GET_ALL_ORDERS_FAIL":return Object(E.a)(Object(E.a)({},e),{},{isLoading:!1,orderList:[],getOrdersFail:a.payload.message});default:return e}},{orderList:[],isLoading:!1,getOrdersFail:null}]}),g=Object(o.a)(f,2),O=g[0],b=g[1],v=r.a.createContext({}),_=function(e){var a=e.children,t=Object(n.useReducer)(O,b),c=Object(o.a)(t,2),s=c[0],l=c[1];return r.a.createElement(v.Provider,{value:{data:s,setData:l}},a)},h=function(){var e=Object(n.useContext)(v),a=e.data,t=e.setData;return[a,Object(n.useCallback)((function(e){var a=e.type,n=e.payload;t({payload:n,type:a})}),[t])]},y=function(e){return{type:"GET_MENU_SUCCESS",payload:e}},S=t(51),j=t.n(S);console.log("production");var N="https://luch-ordering.herokuapp.com",T=t(49),L=t.n(T),R=(t(470),t(225)),D=t(14),C=t.n(D),A=t(217),k=t.n(A),w=function(e){return{type:"ADD_CART_ITEM",payload:e}},U=function(e){var a=e.item,t=Object(n.useState)(1),c=Object(o.a)(t,2),s=c[0],l=c[1],i=h(),u=Object(o.a)(i,2),m=u[0],d=m.currentUser,E=m.cart,p=m.orderTimeout,f=u[1],g=d.user,O=E.cartList;return r.a.createElement("div",{className:C()("menu-item",{"is-disabled":O.some((function(e){return e.id===a._id}))||p.isOrderTimeout})},r.a.createElement("div",{className:"image"},r.a.createElement("img",{className:"img-dish",src:a.img,alt:a.name}),r.a.createElement("div",{onClick:function(){var e={id:a._id,dish_name:a.name,quantity:s};if(g.username)if(0===O.length)f(w(O)),setTimeout((function(){return f({type:"REMOVE_CART_ADDED"})}),500),O.push(e);else{var t=[].concat(Object(R.a)(O),[e]);f(w(t)),setTimeout((function(){return f({type:"REMOVE_CART_ADDED"})}),500)}else window.open("https://luch-ordering.herokuapp.com/google","_self")}},r.a.createElement("img",{className:"icon-add",src:k.a,alt:""}))),r.a.createElement("div",{className:"desc"},r.a.createElement("div",{className:"info"},r.a.createElement("span",{className:"name"},a.name),r.a.createElement("span",{className:"price"},a.price)),r.a.createElement("div",{className:"quantity"},r.a.createElement("input",{type:"number",value:s,onChange:function(e){var a=e.target.value,t=parseInt(a);l(t<=0?1:t>5?5:t)}}))))},I=function(){var e=h(),a=Object(o.a)(e,2),t=a[0].menu,c=a[1],s=function(){var e=h(),a=Object(o.a)(e,2)[1];return Object(n.useCallback)(Object(d.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a({type:"GET_MENU_LOADING"}),e.prev=1,e.next=4,j.a.get("".concat(N,"/menuList")).then((function(e){return e.data}));case 4:t=e.sent,a(y(t)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),a({type:"GET_MENU_FAIL",payload:e.t0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))),[a])}(),l=t.isLoading,i=t.menuList;return Object(n.useEffect)((function(){var e=function(){var e=Object(d.a)(m.a.mark((function e(){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.get("".concat(N,"/user"),{withCredentials:!0}).then((function(e){return e.data}));case 2:a=e.sent,localStorage.setItem("roles",a.roles),c({type:"GET_CUR_USER_SUCCESS",payload:a});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();s(),e()}),[c,s]),r.a.createElement("div",{className:"menu-wrapper"},l&&r.a.createElement("img",{className:"icon-loading",src:L.a,alt:"loading-spinner"}),i.map((function(e){return r.a.createElement(U,{key:e._id,item:e})})))},M=t(218),F=t.n(M),x=function(e){var a=e.order,t=h(),n=Object(o.a)(t,2)[1];return r.a.createElement("div",{className:"cart-item"},r.a.createElement("div",{className:"name"},a.dish_name),r.a.createElement("div",{className:"desc"},r.a.createElement("div",{className:"qty"},a.quantity),r.a.createElement("span",{className:"remove",onClick:function(){n(function(e){return{type:"DELETE_CART_ITEM",payload:e}}(a))}},r.a.createElement("img",{src:F.a,alt:"remove-order"}))))},G=function(e){return{type:"SUBMIT_ORDERS_FAIL",payload:e}},q=function(e){return{type:"GET_ORDERS_SUCCESS",payload:e}},B=function(e){return{type:"GET_ALL_ORDERS_SUCCESS",payload:e}},Q=function(e){return j.a.post("".concat(N,"/orders/create"),e).then((function(e){return e.data}))},J=t(219),P=t.n(J),V=(t(471),function(){var e=h(),a=Object(o.a)(e,1)[0],t=a.currentUser,c=a.cart,s=a.submitOrder,l=c.cartList,i=c.cartAdded,u=s.isLoading,E=Object(n.useState)(!1),p=Object(o.a)(E,2),f=p[0],g=p[1],O=function(){var e=h(),a=Object(o.a)(e,2)[1];return Object(n.useCallback)(function(){var e=Object(d.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a({type:"SUBMIT_ORDERS_REQUEST"}),e.prev=1,e.next=4,Q(t);case 4:e.sent,a({type:"SUBMIT_ORDERS_SUCCESS"}),a({type:"DELETE_CART"}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),a(G(e.t0));case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(a){return e.apply(this,arguments)}}(),[a])}();return r.a.createElement("div",{className:"cart-wrapper"},r.a.createElement("div",{className:C()("cart-icon",{shake:i}),onClick:function(){return g(!f)}},r.a.createElement("img",{src:P.a,alt:"cart-icon"}),r.a.createElement("span",{className:"cart-qty"},l.length)),r.a.createElement("div",{className:C()("cart-content",{show:f&&l.length})},u&&r.a.createElement("img",{className:"cart-loading",src:L.a,alt:""}),l.map((function(e){return r.a.createElement(x,{key:e.id,order:e})})),r.a.createElement("button",{className:"btn-order",onClick:function(){var e=l.map((function(e){return{dish_name:e.dish_name,quantity:e.quantity,name:t.user.username,price:35,date:(new Date).toDateString()}}));O(e)}},"Order")))}),z=t(70),H=t(220),Y=t.n(H),X=(t(472),function(){var e=new Date,a=e.getFullYear(),t=e.getMonth(),c=e.getDate(),s=new Date(a,t,c,23,59,0,0).getTime(),l=new Date(a,t,c,8,0,0,0).getTime(),i=(new Date).getTime()>=l,u=Object(n.useState)({hours:0,minutes:0,seconds:0}),m=Object(o.a)(u,2),d=m[0],E=m[1],p=Object(n.useState)(s),f=Object(o.a)(p,1)[0],g=Object(n.useState)(!1),O=Object(o.a)(g,2),b=O[0],v=O[1],_=Object(n.useCallback)((function(){if(f){var e=(new Date).getTime(),a=f-e,t=Math.floor(a%36e5/6e4),n=Math.floor(a%6e4/1e3),r=[1,2,3,4,5,6,7,8,9],c=Math.floor(a%864e5/36e5);r.includes(c)&&(c="0".concat(c)),r.includes(t)&&(t="0".concat(t)),r.includes(n)&&(n="0".concat(n)),E({hours:c,minutes:t,seconds:n}),v(c<=0&&t<=0&&n<=0)}}),[f]);Object(n.useEffect)((function(){if(setInterval((function(){return _()}),1e3),b)return function(){return clearInterval(_)}}),[b,_]);var h=d.hours,y=d.minutes,S=d.seconds;return r.a.createElement("div",{className:"countdown"},h>=0&&y>=0&&S>0&&r.a.createElement("div",null,r.a.createElement("p",{className:"countdown-message"},"Th\u1eddi gian order c\u1ee7a b\u1ea1n c\xf2n l\u1ea1i"),r.a.createElement("span",null,h),r.a.createElement("span",null,y),r.a.createElement("span",null,S)),r.a.createElement(z.a,{className:"food-modal",show:b||!i,onHide:function(){},backdrop:"static",keyboard:!1,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0},r.a.createElement(z.a.Body,{className:"food-modal__body"},r.a.createElement("img",{className:"timeout-icon",src:Y.a,alt:"forbiden-order"}),b&&r.a.createElement("div",{className:"timeout-message"},"Th\u1eddi gian order c\u01a1m h\xf4m nay \u0111\xe3 h\u1ebft, b\u1ea1n vui l\xf2ng quay l\u1ea1i v\xe0o l\xfac"," ",r.a.createElement("span",{className:"note"},"9h30")," ng\xe0y mai nh\xe9!!!"),!i&&r.a.createElement("div",{className:"timeout-message"},"Th\u1eddi gian order ch\u01b0a t\u1edbi, b\u1ea1n vui l\xf2ng quay l\u1ea1i v\xe0o l\xfac"," ",r.a.createElement("span",{className:"note"},"9h30")," nh\xe9!!!"))))}),K=t(221),W=t.n(K),Z=t(222),$=t.n(Z),ee=(t(476),t(477),function(){var e=h(),a=Object(o.a)(e,1)[0].submitOrder.createOrderSuccess,t=Object(n.useState)(a),c=Object(o.a)(t,2),s=c[0],l=c[1],u=Object(i.g)(),m="admin"===localStorage.getItem("roles");Object(n.useEffect)((function(){a&&l(a)}),[a]);var d=function(){l(!1)};return r.a.createElement("div",{className:"page"},r.a.createElement("h1",{className:"text-uppercase text-center"},"SP Team Luch Ordering"),!m&&r.a.createElement(X,null),r.a.createElement("a",{href:"/orders",className:"icon-orders"},r.a.createElement("img",{src:$.a,alt:"checklist"})),r.a.createElement(V,null),r.a.createElement(I,null),r.a.createElement(z.a,{className:"congrats-modal food-modal",show:s,onHide:d,backdrop:"static",keyboard:!0,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0},r.a.createElement(z.a.Body,{className:"food-modal__body"},r.a.createElement("img",{className:"modal-icon",src:W.a,alt:"forbiden-order"}),r.a.createElement("div",{className:"congrats-message"},"Thank you! B\u1ea1n \u0111\xe3 order th\xe0nh c\xf4ng!!",r.a.createElement("p",null,"Ch\xfac Ngon mi\u1ec7ng")),r.a.createElement("div",{className:"congrats-button"},r.a.createElement("button",{className:"btn-close",onClick:d},"\u0110\xf3ng"),r.a.createElement("button",{className:"go-order",onClick:function(){u.push("/orders")}},"Xem order")))))}),ae=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],te=setInterval((function(e,a,t){new Date(e,a,t,13,45,0,0).getTime()-(new Date).getTime()<0&&clearInterval(te)}),1e3),ne=function(e,a){return e.reduce((function(e,t){var n=t[a];return e[n]=e[n]||[],e[n].push(t),e}),{})},re=function(e){var a=e.order,t=e.isAdmin;return r.a.createElement("div",{key:a._id,className:"order-item"},r.a.createElement("span",{className:"name"},a.name),r.a.createElement("span",{className:"quantity"},a.quantity),r.a.createElement("span",{className:"date"},function(e){if(e){var a=new Date(e),t=a.getDate(),n=a.getMonth(),r=ae[n],c=a.getFullYear();return"".concat(t," ").concat(r," ").concat(c)}}(a.date)),r.a.createElement("span",{className:"dish-name"},a.dish_name),r.a.createElement("span",{className:"price"},"".concat(a.price,".000\u0111")),t&&r.a.createElement("span",{className:"paid"},r.a.createElement("input",{type:"checkbox"}),r.a.createElement("span",{className:"check-mask"})))},ce=(t(215),function(){var e=h(),a=Object(o.a)(e,2),t=a[0].orders,c=t.orderList,s=t.isLoading,l=a[1],i="admin"===localStorage.getItem("roles");Object(n.useEffect)((function(){(function(){var e=Object(d.a)(m.a.mark((function e(a){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l({type:"GET_ORDERS_REQUEST"}),e.prev=1,e.next=4,j.a.get("".concat(N,"/orders/list")).then((function(e){return e.data}));case 4:t=e.sent,l(q(t)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),l({type:"GET_ORDERS_FAIL",payload:e.t0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(a){return e.apply(this,arguments)}})()()}),[l]);var u=c.sort((function(e,a){return e.dish_name.localeCompare(a.name)})),E=ne(c,"dish_name"),p=Object.keys(E).map((function(e){return{name:e,qty:E[e].reduce((function(e,a){return e+a.quantity}),0),price:E[e].reduce((function(e,a){return e+a.price*a.quantity}),0)}})),f=p.reduce((function(e,a){return e+a.qty}),0),g=p.reduce((function(e,a){return e+a.price}),0);return r.a.createElement("div",{className:"page"},r.a.createElement("div",{className:"order-wrapper"},r.a.createElement("h1",{className:"order-title"},"Orders List"),0!==c.length&&r.a.createElement("div",{className:"order-total"},r.a.createElement("h3",{className:"title"},"Total List"),r.a.createElement("div",{className:"header"},r.a.createElement("span",null,"T\xean m\xf3n"),r.a.createElement("span",null,"S\u1ed1 L\u01b0\u1ee3ng"),r.a.createElement("span",null,"Gi\xe1")),p.map((function(e){return r.a.createElement("div",{key:e.name,className:"item"},r.a.createElement("span",null,e.name),r.a.createElement("span",null,e.qty),r.a.createElement("span",null,"".concat(e.price,".000\u0111")))})),r.a.createElement("div",{className:"total"},r.a.createElement("span",null,"T\u1ed5ng c\u1ed9ng"),r.a.createElement("span",null,f),r.a.createElement("span",null,"".concat(g,".000\u0111")))),s&&r.a.createElement("img",{className:"icon-loading",src:L.a,alt:"loading-spinner"}),0!==u.length&&r.a.createElement("div",{className:"order-content"},r.a.createElement("div",{className:"order-item__title"},r.a.createElement("span",null,"Ng\u01b0\u1eddi Order"),r.a.createElement("span",null,"S\u1ed1 L\u01b0\u1ee3ng"),r.a.createElement("span",null,"Ng\xe0y Order"),r.a.createElement("span",null,"T\xean M\xf3n"),r.a.createElement("span",null,"Gi\xe1"),i&&r.a.createElement("span",{className:"paid"},"Paid")),u.map((function(e){return r.a.createElement(re,{key:e._id,order:e,isAdmin:i})})))))}),se=function(){var e=h(),a=Object(o.a)(e,2),t=a[0].allOrders,c=t.orderList,s=t.isLoading,l=a[1],i="admin"===localStorage.getItem("roles");Object(n.useEffect)((function(){(function(){var e=Object(d.a)(m.a.mark((function e(a){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l({type:"GET_ALL_ORDERS_REQUEST"}),e.prev=1,e.next=4,j.a.get("".concat(N,"/orders/all")).then((function(e){return e.data}));case 4:t=e.sent,l(B(t)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),l({type:"GET_ALL_ORDERS_FAIL",payload:e.t0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(a){return e.apply(this,arguments)}})()()}),[l]);var u=c.sort((function(e,a){return e.dish_name.localeCompare(a.dish_name)})),E=ne(c,"date");return console.log(E),r.a.createElement("div",{className:"order-wrapper"},r.a.createElement("h1",{className:"order-title"},"All Orders List"),s&&r.a.createElement("img",{className:"icon-loading",src:L.a,alt:"loading-spinner"}),0!==u.length&&r.a.createElement("div",{className:"order-content"},r.a.createElement("div",{className:"order-item__title"},r.a.createElement("span",null,"T\xean M\xf3n"),r.a.createElement("span",null,"S\u1ed1 L\u01b0\u1ee3ng"),r.a.createElement("span",null,"Ng\xe0y Order"),r.a.createElement("span",null,"Ng\u01b0\u1eddi Order"),i&&r.a.createElement("span",{className:"paid"},"Paid")),Object.keys(E).map((function(e){return console.log(),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"order-item__date-title",key:e},e),E[e].map((function(e){return r.a.createElement(re,{order:e,isAdmin:!0})})))}))))},le=t(226),ie=function(e){var a=e.component,t=Object(le.a)(e,["component"]),n="admin"===localStorage.getItem("roles");return r.a.createElement(i.b,Object.assign({},t,{render:function(e){var t=e.location;return n?r.a.createElement(a,null):r.a.createElement(i.a,{to:{pathname:"/",state:{from:t}}})}}))},oe=t(224),ue=t.n(oe),me=(t(480),t(481),function(){return r.a.createElement("div",{className:"main-wrapper"},r.a.createElement("div",{className:"container"},r.a.createElement("a",{href:"/",className:"main-logo"},r.a.createElement("img",{src:ue.a,alt:"logo"})),r.a.createElement(l.a,null,r.a.createElement(i.d,null,r.a.createElement(i.b,{exact:!0,path:"/"},r.a.createElement(ee,null)),r.a.createElement(i.b,{path:"/orders"},r.a.createElement(ce,null)),r.a.createElement(ie,{path:"/allOrders",component:se})))))});t(482);s.a.render(r.a.createElement(_,null,r.a.createElement(me,null)),document.getElementById("root"))},49:function(e,a,t){e.exports=t.p+"static/media/loading.546dec86.svg"}},[[227,1,2]]]);
//# sourceMappingURL=main.0fb95c3a.chunk.js.map